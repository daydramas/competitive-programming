#include <bits/stdc++.h>
using namespace std;

// structures and defines
#define MOD 1000000007
// global variables

ifstream fin ("input.in");

// functions
bool check(string str) {
	int val = -1;
	for (int i=0; i<str.size(); i++) {
		if (val == -1) {
			val = str[i];
		} else if (val != str[i]) {
			return false;
		}
	}
	return true;
}
void solve(int t) {
	int N, M; string S;
	fin >> N >> M >> S;
	long long ans;
	if (M > N) {
		ans = (1<<N)%MOD;
	} else if (!check(S)){
		ans = (1<<(M))-1 %MOD;
		bool c = check(S);
		for (int i=0; i<(N-M); i++) {
			ans = (ans*2 - 2) % MOD;
		}
	} else {
		ans = (1<<N) % MOD;
		for (int k=1; k<=(N-M); k++) {
			int i=k-1, j = 0;
			long long sum = 0;
			for (int ki=1; ki<=k+1; ki++, i++) {
				j = max(ki-2, 0);
				sum = (sum + ((1<<i)%MOD*(1<<j)%MOD)%MOD)%MOD;
//				cout << (1<<i)<<" " << (1<<j)<<endl;
				cout << i<<" " << j << endl;
			}
			cout<<"ans: " << ans << " sum: "<<sum<< endl;
			ans -= sum;
		}
	}
	cout<< "Case #"<<t<<": " << ans << endl;
}

int main() {
	// local variables
	int T;

	// input
	fin >> T;

	// main
	for (int i=1; i<=T; i++) solve(i);
	// output

	return 0;
}
