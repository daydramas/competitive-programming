#include <bits/stdc++.h>
using namespace std;

// structures and defines
#define lli long long int
// global variables

// functions
lli getexp(lli a, lli b, lli M) {
	lli r = 1;
	for (int i=1; i<=b; i++) r = (r*a)%M;
	return r;
}
void solve() {
	lli N, M, R; cin >> N >> M >> R;
	lli sum = 1LL*(1-getexp(R, (N*N), M))/(1-R);
	cout << sum << endl;
}
int main() {
	// local variables
	int T;

	// input
	cin >> T;
	for (int i=0; i<T; i++) {
		solve();
	}
	return 0;
}
