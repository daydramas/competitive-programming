#include <bits/stdc++.h>
using namespace std;

// structures and defines
#define MOD 1000000007
// global variables

ifstream fin ("input.in");

// functions
void computeLPSArray(string pat, int M, int *lps) {
	int len = 0;

	lps[0] = 0;
	int i = 1;
	while (i < M) {
		if (pat[i] == pat[len]) {
			len++;
			lps[i] = len;
			i++;
		} else {
			if (len != 0) {
				len = lps[len - 1];
			} else {
				lps[i] = 0;
				i++;
			}
		}
	}
}
bool check(string str) {
	int val = -1;
	for (int i=0; i<str.size(); i++) {
		if (val == -1) {
			val = str[i];
		} else if (val != str[i]) {
			return false;
		}
	}
	return true;
}
void solve(int t) {
	int N, M; string S;
	fin >> N >> M >> S;
	long long ans;
	if (M > N) {
		ans = (1<<N)%MOD;
	} else if (!check(S)){
		long long dp[N+1];
		dp[0] = 1;
		for (int i=1; i<M; i++) dp[i] = (dp[i-1]*2) % MOD;
		for (int i=M; i<=N; i++) {
			dp[i] = 0;
			for (int j=0; j<=(i-M); j++) {
				dp[i] = (dp[i] + (dp[j]*2)-1 + MOD) % MOD;
			}
		}
		ans = dp[N];
	} else {
		ans = (1<<N) % MOD;
		for (int k=0; k<=(N-M); k++) {
			int i=k-1, j = 0;
			long long sum = 0;
			for (int ki=1; ki<=k+1; ki++, i--) {
				i = max(i, 0);
				j = max(ki-2, 0);
				sum = (sum + ((1<<i)%MOD*(1<<j)%MOD)%MOD)%MOD;
			}
			ans -= sum;
		}
	}
	cout<< "Case #"<<t<<": " << ans << endl;
}

int main() {
	// local variables
	int T;

	// input
	fin >> T;

	// main
	for (int i=1; i<=T; i++) solve(i);
	// output

	return 0;
}
